{
  "kind": "build_request",
  "title": "Fix Daily Order Upload extraction so Weight/Size/Quantity/Remarks parse reliably and show user-visible parse diagnostics",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-49",
      "text": "Improve the Daily Order Upload file parser so it reliably extracts non-empty values for all required fields (Order No, Design, Weight, Size, Quantity, Remarks) from common OrderList Excel/CSV formats, including when there are extra title rows above the real header row, when headers use common variations (e.g., different casing/punctuation, \"Remark's\"), and when there are hidden/unusual whitespace characters.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-3"
        ],
        "quotes": [
          "Please extract the data properly"
        ]
      },
      "acceptanceCriteria": [
        "Uploading a representative OrderList .xlsx/.xls that contains Weight/Size/Quantity/Remarks results in those columns being populated in the parsed output (not blank) when the source file has values.",
        "If the file has extra title rows before the actual header row, the parser still detects the correct header row and maps the correct columns to Order No/Design/Weight/Size/Quantity/Remarks.",
        "If the header labels use common variations (e.g., \"Remark's\", \"Qty.\", \"Net Wt\"), the parser still matches them to the correct required fields.",
        "Parser behavior remains compatible with .csv uploads and does not regress Order No/Design extraction."
      ]
    },
    {
      "id": "REQ-50",
      "text": "Expose Daily Order Upload parsing warnings and detected-header information to the user in the Daily Order Upload UI (in English) instead of only logging warnings to the console, so the user can understand when the file is missing optional columns or when a non-first header row was used.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-3"
        ],
        "quotes": [
          "Please extract the data properly"
        ]
      },
      "acceptanceCriteria": [
        "When optional columns (Weight/Size/Quantity/Remarks) are not detected, the Daily Order Upload page shows a visible, non-crashing warning message listing the missing columns.",
        "When parsing succeeds but uses a header row that is not the first row, the UI indicates which row was treated as the header (e.g., \"Detected headers on row N\").",
        "Warnings do not block saving parsed orders to the backend when parsing otherwise succeeds."
      ]
    },
    {
      "id": "REQ-51",
      "text": "Ensure the Daily Order Upload flow does not crash or abort after parser changes: successful parses must still populate the on-page table and attempt to save to the backend; failures must show a clear English error without losing already-parsed rows when only the save step fails.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-3"
        ],
        "quotes": [
          "Please extract the data properly"
        ]
      },
      "acceptanceCriteria": [
        "After uploading a valid file, the Daily Order Upload page shows the parsed row count and a table including Order No, Design, Weight, Size, Quantity, Remarks.",
        "If parsing succeeds but storing to the backend fails, the parsed orders remain visible in the UI and an English 'saving failed' error is shown (separate from parsing errors).",
        "If parsing fails, the UI shows an English parsing error and does not crash; the file input is reset so the user can retry."
      ]
    }
  ],
  "constraints": [
    "Do not edit any files under frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, or frontend/src/components/ui (compose existing UI components instead).",
    "Backend must remain a single Motoko actor in backend/main.mo; only introduce backend migration (backend/migration.mo) if existing stable state must change."
  ],
  "nonGoals": [
    "Changing backend storage schema for DailyOrder fields (Order No, Design, Weight, Size, Quantity, Remarks).",
    "Adding new authentication or identity requirements.",
    "Implementing new mapping/enrichment logic unrelated to Daily Order field extraction."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}